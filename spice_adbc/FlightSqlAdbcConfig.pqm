let
    TypeInfo = Extension.LoadExpression("TypeInfo.pqm"),
    FlightSqlAdbcConfig = [
        Name = "FlightSqlAdbcSpiceAI",
        Folder = "FlightSQL",
        File = "libadbc_driver_flightsql.dll",
        DriverType = "Unmanaged",
        EntryPoint = "FlightSQLDriverInit",
        IdentifierQuoteChar = """",
        CatalogNameSeparator = ".",
        TableTypes = "BASE TABLE",
        SupportsCatalog = true,
        SupportsSchema = true,
        SupportedConnectionOptions = [
            adbc.connection.catalog = false,
            adbc.connection.db_schema = false
        ],
        TypeInfo = Table.SelectColumns(
            TypeInfo,
            {"Name", "SqlType", "Unsigned", "ColumnSize", "NumberPrecisionRadix", "LiteralPrefix", "LiteralSuffix"}
        )
    ],
    Extension.LoadExpression = (name as text) =>
        let
            binary = Extension.Contents(name), asText = Text.FromBinary(binary)
        in
            Expression.Evaluate(asText, #shared)
in
    FlightSqlAdbcConfig
